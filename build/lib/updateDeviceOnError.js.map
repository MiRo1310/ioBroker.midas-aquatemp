{
  "version": 3,
  "sources": ["../../src/lib/updateDeviceOnError.ts"],
  "sourcesContent": ["import { saveValue } from './saveValue';\nimport { initStore } from './store';\nimport { errorLogger } from './logging';\nimport type { MidasAquatemp } from '../main';\nimport { request } from './axios';\nimport { getHeaders } from './axiosParameter';\nimport type { MidasData } from '../types/types';\nimport { noError } from './utils';\n\nexport async function updateDeviceErrorMsg(adapter: MidasAquatemp): Promise<void> {\n    const store = initStore();\n    try {\n        const { token, apiLevel, cloudURL, device: deviceCode } = store;\n        if (token) {\n            const sURL =\n                apiLevel < 3\n                    ? `${cloudURL}/app/device/getFaultDataByDeviceCode.json`\n                    : `${cloudURL}/app/device/getFaultDataByDeviceCode`;\n\n            const { data } = await request<MidasData>(\n                adapter,\n                sURL,\n                {\n                    device_code: deviceCode,\n                    deviceCode: deviceCode,\n                },\n                getHeaders(token),\n            );\n            if (!data) {\n                return;\n            }\n\n            if (noError(data.error_code)) {\n                await saveValue({ key: 'error', value: true, stateType: 'boolean', adapter: adapter });\n\n                if (apiLevel < 3) {\n                    await saveValue({\n                        key: 'errorMessage',\n                        value: data.object_result?.[0]?.description ?? '',\n                        stateType: 'string',\n                        adapter: adapter,\n                    });\n                    await saveValue({\n                        key: 'errorCode',\n                        value: data.object_result?.[0]?.fault_code,\n                        stateType: 'string',\n                        adapter: adapter,\n                    });\n                    await saveValue({\n                        key: 'errorLevel',\n                        value: data.object_result?.[0]?.error_level,\n                        stateType: 'string',\n                        adapter: adapter,\n                    });\n                    return;\n                }\n                await saveValue({\n                    key: 'errorMessage',\n                    value: data.objectResult?.[0]?.description ?? '',\n                    stateType: 'string',\n                    adapter: adapter,\n                });\n                await saveValue({\n                    key: 'errorCode',\n                    value: data.objectResult?.[0]?.faultCode,\n                    stateType: 'string',\n                    adapter: adapter,\n                });\n                await saveValue({\n                    key: 'errorLevel',\n                    value: data.objectResult?.[0]?.errorLevel,\n                    stateType: 'string',\n                    adapter: adapter,\n                });\n                return;\n            }\n            // Login-Fehler\n            store.resetOnErrorHandler();\n            return;\n        }\n        return;\n    } catch (error: any) {\n        errorLogger('Error in updateDeviceErrorMsg', error, adapter);\n    }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAA0B;AAC1B,mBAA0B;AAC1B,qBAA4B;AAE5B,mBAAwB;AACxB,4BAA2B;AAE3B,mBAAwB;AAExB,eAAsB,qBAAqB,SAAuC;AATlF;AAUI,QAAM,YAAQ,wBAAU;AACxB,MAAI;AACA,UAAM,EAAE,OAAO,UAAU,UAAU,QAAQ,WAAW,IAAI;AAC1D,QAAI,OAAO;AACP,YAAM,OACF,WAAW,IACL,GAAG,QAAQ,8CACX,GAAG,QAAQ;AAErB,YAAM,EAAE,KAAK,IAAI,UAAM;AAAA,QACnB;AAAA,QACA;AAAA,QACA;AAAA,UACI,aAAa;AAAA,UACb;AAAA,QACJ;AAAA,YACA,kCAAW,KAAK;AAAA,MACpB;AACA,UAAI,CAAC,MAAM;AACP;AAAA,MACJ;AAEA,cAAI,sBAAQ,KAAK,UAAU,GAAG;AAC1B,kBAAM,4BAAU,EAAE,KAAK,SAAS,OAAO,MAAM,WAAW,WAAW,QAAiB,CAAC;AAErF,YAAI,WAAW,GAAG;AACd,oBAAM,4BAAU;AAAA,YACZ,KAAK;AAAA,YACL,QAAO,sBAAK,kBAAL,mBAAqB,OAArB,mBAAyB,gBAAzB,YAAwC;AAAA,YAC/C,WAAW;AAAA,YACX;AAAA,UACJ,CAAC;AACD,oBAAM,4BAAU;AAAA,YACZ,KAAK;AAAA,YACL,QAAO,gBAAK,kBAAL,mBAAqB,OAArB,mBAAyB;AAAA,YAChC,WAAW;AAAA,YACX;AAAA,UACJ,CAAC;AACD,oBAAM,4BAAU;AAAA,YACZ,KAAK;AAAA,YACL,QAAO,gBAAK,kBAAL,mBAAqB,OAArB,mBAAyB;AAAA,YAChC,WAAW;AAAA,YACX;AAAA,UACJ,CAAC;AACD;AAAA,QACJ;AACA,kBAAM,4BAAU;AAAA,UACZ,KAAK;AAAA,UACL,QAAO,sBAAK,iBAAL,mBAAoB,OAApB,mBAAwB,gBAAxB,YAAuC;AAAA,UAC9C,WAAW;AAAA,UACX;AAAA,QACJ,CAAC;AACD,kBAAM,4BAAU;AAAA,UACZ,KAAK;AAAA,UACL,QAAO,gBAAK,iBAAL,mBAAoB,OAApB,mBAAwB;AAAA,UAC/B,WAAW;AAAA,UACX;AAAA,QACJ,CAAC;AACD,kBAAM,4BAAU;AAAA,UACZ,KAAK;AAAA,UACL,QAAO,gBAAK,iBAAL,mBAAoB,OAApB,mBAAwB;AAAA,UAC/B,WAAW;AAAA,UACX;AAAA,QACJ,CAAC;AACD;AAAA,MACJ;AAEA,YAAM,oBAAoB;AAC1B;AAAA,IACJ;AACA;AAAA,EACJ,SAAS,OAAY;AACjB,oCAAY,iCAAiC,OAAO,OAAO;AAAA,EAC/D;AACJ;",
  "names": []
}
